; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{3D15123E-BA9C-413E-BDF3-E67AAE948B22}
AppName=c4h
AppVerName=c4h 1.2.0
WizardImageFile=C:\Users\Helmi\Google Drive\Packaging\images\3S_logo_blau.bmp
AppPublisher=3S-Schulsupport
AppPublisherURL=www.3s-hamburg.de
AppSupportURL=www.3s-hamburg.de
AppUpdatesURL=www.3s-hamburg.de
WizardSmallImageFile=C:\Users\Helmi\Google Drive\Packaging\images\3S_logo_blau.bmp
DefaultDirName={pf}\\Schul-Support-Service
DefaultGroupName=c4h
DisableProgramGroupPage=yes
DisableDirPage=yes
UninstallDisplayName=c4h
Uninstallable=yes
LicenseFile=C:\Users\Helmi\Google Drive\Packaging\lizenz.txt
OutputDir=C:\Users\Helmi\Google Drive\Packaging\Output
OutputBaseFilename=c4h_Setup
Compression=lzma
SolidCompression=yes

[Registry]
Root: HKLM; Subkey: "SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run";  ValueName: "C4H_APP";  ValueType: string; ValueData: "{app}\c4h.jar";

[Languages]
Name: "german"; MessagesFile: "compiler:Languages\German.isl"

[Files]
Source: "C:\Users\Helmi\Google Drive\Packaging\jarVersion\c4h.jar"; DestDir: "{app}"; Flags: ignoreversion
Source: "C:\Users\Helmi\Google Drive\Packaging\Deinstallieren.bat"; DestDir: "{app}"; Flags: ignoreversion
Source: "C:\Users\Helmi\Google Drive\Packaging\readme.txt"; DestDir: "{app}"; Flags: ignoreversion

; NOTE: Don't use "Flags: ignoreversion" on any shared system files


[Icons]
Name: "{group}\c4h"; Filename: "{app}\c4h.jar"

[Run]
Filename: "{app}\c4h.jar"; Description: "{cm:LaunchProgram,c4h}"; Flags: shellexec postinstall skipifsilent



[UninstallDelete]



Type:files; Name: "{app}"

   [code]
   function InitializeSetup(): Boolean;
   var
   ResultCode : Integer;
   begin
   Result := True;
   Exec('cmd.exe','/c TASKKILL /F /IM javaw.exe' , '',SW_HIDE, ewWaitUntilTerminated, ResultCode);
   end;

function InitializeUninstall(): Boolean;
var
  ResultCode : Integer;
begin
  Result := True;
  Exec(ExpandConstant('{app}\Deinstallieren.bat'), '', '',
       SW_HIDE, ewWaitUntilTerminated, ResultCode);
end;



