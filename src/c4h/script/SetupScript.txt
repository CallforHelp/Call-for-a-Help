; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{3D15123E-BA9C-413E-BDF3-E67AAE948B22}
AppName=c4h
AppVerName=c4h 1.0.2
WizardImageFile=C:\Users\bani\iCloudDrive\Packaging\images\3S_logo_blau.bmp
AppPublisher=3S-Schulsupport
AppPublisherURL=www.3s-hamburg.de
AppSupportURL=www.3s-hamburg.de
AppUpdatesURL=www.3s-hamburg.de
WizardSmallImageFile=C:\Users\bani\iCloudDrive\Packaging\images\3S_logo_blau.bmp
DefaultDirName={pf}\Schul-Support-Service\C4H
DefaultGroupName=c4h
DisableProgramGroupPage=yes
DisableDirPage=yes
UninstallDisplayName=c4h
Uninstallable=yes
LicenseFile=C:\Users\bani\iCloudDrive\Packaging\lizenz.txt
OutputDir=C:\Users\bani\iCloudDrive\Packaging\Output
OutputBaseFilename=setup_C4H
Compression=lzma
SolidCompression=yes

[Registry]
Root: HKLM; Subkey: "SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run";  ValueName: "C4H_APP";  ValueType: string; ValueData: "{app}\c4h.jar";

[Languages]
Name: "german"; MessagesFile: "compiler:Languages\German.isl"

[Files]
Source: "C:\Users\bani\iCloudDrive\Packaging\jarVersion\c4h.jar"; DestDir: "{app}"; Flags: ignoreversion
Source: "C:\Users\bani\iCloudDrive\Packaging\Deinstallieren.bat"; DestDir: "{app}"; Flags: ignoreversion
Source: "C:\Users\bani\iCloudDrive\Packaging\readme.txt"; DestDir: "{app}"; Flags: ignoreversion

; NOTE: Don't use "Flags: ignoreversion" on any shared system files


[Icons]
Name: "{group}\c4h"; Filename: "{app}\c4h.jar"

[Run]
Filename: "{app}\c4h.jar"; Description: "{cm:LaunchProgram,c4h}"; Flags: shellexec postinstall skipifsilent


     
[UninstallDelete]
   
   [code]
         function InitializeSetup(): Boolean;
         var
         ResultCode : Integer;
         
         begin
         Result := True;
         Exec('cmd.exe','/c TASKKILL /F /IM javaw.exe' , '',SW_HIDE, ewWaitUntilTerminated, ResultCode);
         
         end;
   
   [code]
        function InitializeUninstall(): Boolean;
        var
        ResultCode : Integer;
        
        begin
        Result := True;
        Exec(ExpandConstant('{app}\deinstallieren.bat'), '', '',
                            SW_HIDE, ewWaitUntilTerminated, ResultCode);
        
        end;


